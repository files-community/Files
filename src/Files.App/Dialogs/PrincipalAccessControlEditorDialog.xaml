<!--  Copyright (c) 2023 Files Community. Licensed under the MIT License. See the LICENSE.  -->
<ContentDialog
	x:Class="Files.App.Dialogs.PrincipalAccessControlEditorDialog"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:helpers="using:Files.App.Helpers"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:wctconverters="using:CommunityToolkit.WinUI.UI.Converters"
	Title="{x:Bind ModifiableModel.DialogTitle, Mode=OneWay}"
	DefaultButton="Primary"
	PrimaryButtonText="{helpers:ResourceString Name=Save}"
	RequestedTheme="{x:Bind helpers:ThemeHelper.RootTheme}"
	SecondaryButtonText="{helpers:ResourceString Name=Cancel}"
	Style="{StaticResource DefaultContentDialogStyle}"
	mc:Ignorable="d">

	<ContentDialog.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<ResourceDictionary Source="ms-appx:///ResourceDictionaries/RightAlignedToggleSwitchStyle.xaml" />
			</ResourceDictionary.MergedDictionaries>

			<wctconverters:BoolNegationConverter x:Key="BoolNegationConverter" />
			<wctconverters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
			<wctconverters:BoolToObjectConverter
				x:Key="NegateBoolToVisibilityConverter"
				FalseValue="Visible"
				TrueValue="Collapsed" />

		</ResourceDictionary>
	</ContentDialog.Resources>

	<Grid Margin="0,0,0,-24" RowSpacing="24">

		<ScrollViewer
			Height="365"
			MinWidth="360"
			VerticalScrollBarVisibility="Hidden">
			<StackPanel Margin="0,0,0,24" Spacing="16">

				<!--  Principal  -->
				<StackPanel Grid.Row="0" Spacing="8">
					<TextBlock
						Foreground="{ThemeResource TextFillColorSecondaryBrush}"
						Style="{StaticResource CaptionTextBlockStyle}"
						Text="Principal:" />
					<TextBlock IsTextSelectionEnabled="True" Style="{StaticResource BodyTextBlockStyle}">
						<Run Text="{x:Bind ModifiableModel.Principal.DisplayName, Mode=OneWay}" />
						<Run Foreground="{ThemeResource TextFillColorSecondaryBrush}" Text="{x:Bind ModifiableModel.Principal.FullNameHumanizedWithBrackes, Mode=OneWay}" />
					</TextBlock>
				</StackPanel>

				<!--  Access Type  -->
				<StackPanel
					x:Name="AccessControlTypePanel"
					Grid.Row="1"
					Spacing="8">
					<TextBlock
						Foreground="{ThemeResource TextFillColorSecondaryBrush}"
						Style="{StaticResource CaptionTextBlockStyle}"
						Text="Access Type:" />
					<ComboBox
						x:Name="AccessControlTypeComboBox"
						MinWidth="256"
						IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}"
						ItemsSource="{x:Bind ModifiableModel.PossibleAccessControlTypes, Mode=OneWay}"
						SelectedItem="{x:Bind ModifiableModel.SelectedAccessControlType, Mode=TwoWay}" />
				</StackPanel>

				<!--  Access Inheritance Applies To  -->
				<StackPanel
					x:Name="AccessInheritanceAppliesToTypePanel"
					Grid.Row="1"
					x:Load="{x:Bind ModifiableModel.IsFolder, Mode=OneWay}"
					Spacing="8">
					<TextBlock
						Foreground="{ThemeResource TextFillColorSecondaryBrush}"
						Style="{StaticResource CaptionTextBlockStyle}"
						Text="Applies to:" />
					<ComboBox
						x:Name="AccessInheritanceAppliesToTypeComboBox"
						MinWidth="256"
						IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}"
						ItemsSource="{x:Bind ModifiableModel.PossibleAccessControlInheritanceAppliesToHumanizedTypes, Mode=OneWay}"
						SelectedIndex="{x:Bind ModifiableModel.SelectedAccessControlInheritanceAppliesToTypeIndex, Mode=TwoWay}" />
				</StackPanel>

				<!--  Access Controls  -->
				<StackPanel Grid.Row="2" Spacing="8">
					<Grid HorizontalAlignment="Stretch" VerticalAlignment="Top">
						<TextBlock
							HorizontalAlignment="Left"
							VerticalAlignment="Top"
							Foreground="{ThemeResource TextFillColorSecondaryBrush}"
							Style="{StaticResource CaptionTextBlockStyle}"
							Text="Permissions:" />
						<HyperlinkButton
							x:Name="BasicAdvancedToggleSwitch"
							Padding="0"
							HorizontalAlignment="Right"
							VerticalAlignment="Top"
							Command="{x:Bind ModifiableModel.TogglePermissionsVisibilityCommand, Mode=OneWay}"
							Content="{x:Bind ModifiableModel.PermissionsVisibilityToggleLinkButtonContent, Mode=OneWay}" />
					</Grid>
					<Grid>
						<StackPanel
							x:Name="BasicPermissionsPanel"
							VerticalAlignment="Top"
							Orientation="Vertical"
							Visibility="{x:Bind ModifiableModel.ShowAdvancedPermissions, Converter={StaticResource NegateBoolToVisibilityConverter}, Mode=OneWay}">
							<CheckBox
								x:Name="BasicPermissionFullControlCheckBox"
								Content="Full control"
								IsChecked="{x:Bind ModifiableModel.FullControlAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="BasicPermissionModifyCheckBox"
								Content="Modify"
								IsChecked="{x:Bind ModifiableModel.BasicModifyAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="BasicPermissionReadAndExecuteCheckBox"
								Content="Read &amp; Execute"
								IsChecked="{x:Bind ModifiableModel.BasicReadAndExecuteAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="BasicPermissionListFolderContentsCheckBox"
								x:Load="{x:Bind ModifiableModel.IsFolder, Mode=OneWay}"
								Content="List folder contents"
								IsChecked="{x:Bind ModifiableModel.BasicReadAndExecuteAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="BasicPermissionReadCheckBox"
								Content="Read"
								IsChecked="{x:Bind ModifiableModel.BasicReadAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="BasicPermissionWriteCheckBox"
								Content="Write"
								IsChecked="{x:Bind ModifiableModel.BasicWriteAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="BasicPermissionSpecialCheckBox"
								Content="Special permissions"
								IsChecked="{x:Bind ModifiableModel.BasicSpecialPermissionsAccessControl, Mode=OneWay}"
								IsEnabled="False" />
						</StackPanel>
						<StackPanel
							x:Name="AdvancedPermissionsPanel"
							VerticalAlignment="Top"
							Orientation="Vertical"
							Visibility="{x:Bind ModifiableModel.ShowAdvancedPermissions, Converter={StaticResource BoolToVisibilityConverter}, Mode=OneWay}">
							<CheckBox
								x:Name="AdvancedPermissionFullControlAccessCheckBox"
								Content="Full control"
								IsChecked="{x:Bind ModifiableModel.FullControlAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionTraverseAccessCheckBox"
								Content="Traverse folder / execute file"
								IsChecked="{x:Bind ModifiableModel.AdvancedTraverseAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionReadDataAccessCheckBox"
								Content="List folder / read data"
								IsChecked="{x:Bind ModifiableModel.AdvancedReadDataAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionReadAttributesAccessCheckBox"
								Content="Read attributes"
								IsChecked="{x:Bind ModifiableModel.AdvancedReadAttributesAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionReadExtendedAttributesAccessCheckBox"
								Content="Read extended attributes"
								IsChecked="{x:Bind ModifiableModel.AdvancedReadExtendedAttributesAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionWriteDataAccessCheckBox"
								Content="Create files / write data"
								IsChecked="{x:Bind ModifiableModel.AdvancedWriteDataAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionAppendDataAccessCheckBox"
								Content="Create folders / append data"
								IsChecked="{x:Bind ModifiableModel.AdvancedAppendDataAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionWriteAttributesAccessCheckBox"
								Content="Write attributes"
								IsChecked="{x:Bind ModifiableModel.AdvancedWriteAttributesAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionWriteExtendedAttributesAccessCheckBox"
								Content="Write extended attributes"
								IsChecked="{x:Bind ModifiableModel.AdvancedWriteExtendedAttributesAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionDeleteSubfoldersAndFilesAccessCheckBox"
								Content="Delete subfolders and files"
								IsChecked="{x:Bind ModifiableModel.AdvancedDeleteSubfoldersAndFilesAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionDeleteAccessCheckBox"
								Content="Delete"
								IsChecked="{x:Bind ModifiableModel.AdvancedDeleteAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionReadPermissionsAccessCheckBox"
								Content="Read permissions"
								IsChecked="{x:Bind ModifiableModel.AdvancedReadPermissionsAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionChangePermissionsAccessCheckBox"
								Content="Change permissions"
								IsChecked="{x:Bind ModifiableModel.AdvancedChangePermissionsAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
							<CheckBox
								x:Name="AdvancedPermissionTakeOwnershipAccessCheckBox"
								Content="Take ownership"
								IsChecked="{x:Bind ModifiableModel.AdvancedTakeOwnershipAccessControl, Mode=TwoWay}"
								IsEnabled="{x:Bind ModifiableModel.IsInherited, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}" />
						</StackPanel>
					</Grid>
				</StackPanel>

			</StackPanel>
		</ScrollViewer>

	</Grid>
</ContentDialog>
