<!--  Copyright (c) 2023 Files Community. Licensed under the MIT License. See the LICENSE.  -->
<vm:BasePropertiesPage
	x:Class="Files.App.Views.Properties.CompatibilityPage"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:converters="using:Files.App.Converters"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:helpers="using:Files.App.Helpers"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:uc="using:Files.App.UserControls"
	xmlns:vm="using:Files.App.ViewModels.Properties"
	Loaded="Properties_Loaded"
	Tag="Compatibility"
	mc:Ignorable="d">

	<vm:BasePropertiesPage.Resources>
		<ResourceDictionary>

			<converters:NullToTrueConverter x:Key="NullToFalseConverter" Inverse="True" />

		</ResourceDictionary>
	</vm:BasePropertiesPage.Resources>

	<ScrollViewer x:Name="RootScrollViewer">
		<StackPanel Padding="12" Spacing="4">

			<!--  Run Troubleshooter  -->
			<uc:SettingsCard
				Command="{x:Bind CompatibilityProperties.RunTroubleshooterCommand}"
				Header="{helpers:ResourceString Name=RunCompatibilityTroubleShooter}"
				IsClickEnabled="True">
				<uc:SettingsCard.ActionIcon>
					<FontIcon Glyph="&#xE8A7;" />
				</uc:SettingsCard.ActionIcon>
			</uc:SettingsCard>

			<!--  Compatibility Mode  -->
			<uc:SettingsCard HorizontalAlignment="Stretch" Header="{helpers:ResourceString Name=CompatibilityMode}">
				<ComboBox
					AutomationProperties.Name="{helpers:ResourceString Name=CompatibilityMode}"
					DisplayMemberPath="Name"
					IsEnabled="{x:Bind CompatibilityProperties.CompatibilityOptions, Mode=OneWay, Converter={StaticResource NullToFalseConverter}}"
					ItemsSource="{x:Bind CompatibilityProperties.OSCompatibilityList, Mode=OneWay}"
					SelectedValue="{x:Bind CompatibilityProperties.OSCompatibility, Mode=TwoWay}" />
			</uc:SettingsCard>

			<!--  Reduce Color Mode  -->
			<uc:SettingsCard HorizontalAlignment="Stretch" Header="{helpers:ResourceString Name=ReducedColorMode}">
				<ComboBox
					AutomationProperties.Name="{helpers:ResourceString Name=ReducedColorMode}"
					DisplayMemberPath="Name"
					IsEnabled="{x:Bind CompatibilityProperties.CompatibilityOptions, Mode=OneWay, Converter={StaticResource NullToFalseConverter}}"
					ItemsSource="{x:Bind CompatibilityProperties.ReducedColorModeList, Mode=OneWay}"
					SelectedValue="{x:Bind CompatibilityProperties.ReducedColorMode, Mode=TwoWay}" />
			</uc:SettingsCard>

			<!--  Run Low Resolution  -->
			<uc:SettingsCard HorizontalAlignment="Stretch" Header="{helpers:ResourceString Name=ExecuteAt640X480}">
				<ToggleSwitch
					AutomationProperties.Name="{helpers:ResourceString Name=ExecuteAt640X480}"
					IsEnabled="{x:Bind CompatibilityProperties.CompatibilityOptions, Mode=OneWay, Converter={StaticResource NullToFalseConverter}}"
					IsOn="{x:Bind CompatibilityProperties.ExecuteAt640X480, Mode=TwoWay}"
					Style="{StaticResource RightAlignedCompactToggleSwitchStyle}" />
			</uc:SettingsCard>

			<!--  Full Screen Optimizations  -->
			<uc:SettingsCard HorizontalAlignment="Stretch" Header="{helpers:ResourceString Name=DisableFullscreenOptimizations}">
				<ToggleSwitch
					AutomationProperties.Name="{helpers:ResourceString Name=DisableFullscreenOptimizations}"
					IsEnabled="{x:Bind CompatibilityProperties.CompatibilityOptions, Mode=OneWay, Converter={StaticResource NullToFalseConverter}}"
					IsOn="{x:Bind CompatibilityProperties.DisableMaximized, Mode=TwoWay}"
					Style="{StaticResource RightAlignedCompactToggleSwitchStyle}" />
			</uc:SettingsCard>

			<!--  Run As  -->
			<uc:SettingsCard HorizontalAlignment="Stretch" Header="{helpers:ResourceString Name=RunAsAdministrator}">
				<ToggleSwitch
					AutomationProperties.Name="{helpers:ResourceString Name=DisableFullscreenOptimizations}"
					IsEnabled="{x:Bind CompatibilityProperties.CompatibilityOptions, Mode=OneWay, Converter={StaticResource NullToFalseConverter}}"
					IsOn="{x:Bind CompatibilityProperties.RunAsAdministrator, Mode=TwoWay}"
					Style="{StaticResource RightAlignedCompactToggleSwitchStyle}" />
			</uc:SettingsCard>

			<!--  Register For Restart  -->
			<uc:SettingsCard HorizontalAlignment="Stretch" Header="{helpers:ResourceString Name=RegisterForRestart}">
				<ToggleSwitch
					AutomationProperties.Name="{helpers:ResourceString Name=RegisterForRestart}"
					IsEnabled="{x:Bind CompatibilityProperties.CompatibilityOptions, Mode=OneWay, Converter={StaticResource NullToFalseConverter}}"
					IsOn="{x:Bind CompatibilityProperties.RegisterForRestart, Mode=TwoWay}"
					Style="{StaticResource RightAlignedCompactToggleSwitchStyle}" />
			</uc:SettingsCard>

			<!--  Use Main Monitor DPI Settings  -->
			<uc:SettingsCard HorizontalAlignment="Stretch" Header="{helpers:ResourceString Name=UseMainMonitorDPISettings}">
				<ComboBox
					AutomationProperties.Name="{helpers:ResourceString Name=UseMainMonitorDPISettings}"
					DisplayMemberPath="Name"
					IsEnabled="{x:Bind CompatibilityProperties.CompatibilityOptions, Mode=OneWay, Converter={StaticResource NullToFalseConverter}}"
					ItemsSource="{x:Bind CompatibilityProperties.HighDpiOptionList, Mode=OneWay}"
					SelectedValue="{x:Bind CompatibilityProperties.HighDpiOption, Mode=TwoWay}" />
			</uc:SettingsCard>

			<!--  Override High DPI Scaling Behavior  -->
			<uc:SettingsCard HorizontalAlignment="Stretch" Header="{helpers:ResourceString Name=OverrideDPIScalingBehaviour}">
				<ComboBox
					AutomationProperties.Name="{helpers:ResourceString Name=OverrideDPIScalingBehaviour}"
					DisplayMemberPath="Name"
					IsEnabled="{x:Bind CompatibilityProperties.CompatibilityOptions, Mode=OneWay, Converter={StaticResource NullToFalseConverter}}"
					ItemsSource="{x:Bind CompatibilityProperties.HighDpiOverrideList, Mode=OneWay}"
					SelectedValue="{x:Bind CompatibilityProperties.HighDpiOverride, Mode=TwoWay}" />
			</uc:SettingsCard>

		</StackPanel>
	</ScrollViewer>
</vm:BasePropertiesPage>
