<!--  Copyright (c) 2023 Files Community. Licensed under the MIT License. See the LICENSE.  -->
<UserControl
	x:Class="Files.App.UserControls.SideBar.SideBarView"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:sidebar="using:Files.App.UserControls.SideBar"
	xmlns:triggers="using:CommunityToolkit.WinUI.UI.Triggers"
	HorizontalAlignment="Stretch"
	Loaded="SideBarView_Loaded"
	SizeChanged="SideBarView_SizeChanged"
	mc:Ignorable="d">

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<!--  This is a special spot just for tabs so that the title bar DragArea can function properly  -->
		<Border
			x:Name="TabContentBorder"
			VerticalAlignment="Top"
			Canvas.ZIndex="2" />
		<Button
			x:Name="TogglePaneButton"
			Margin="4"
			HorizontalAlignment="Left"
			VerticalAlignment="Top"
			Background="Transparent"
			BorderThickness="0"
			Click="TogglePaneButton_Click"
			Style="{StaticResource PaneToggleButtonStyle}"
			Visibility="Collapsed" />
		<sidebar:SideBarPane
			x:Name="SideBar"
			Grid.Row="1"
			DisplayMode="{x:Bind DisplayMode, Mode=OneWay}"
			InnerContent="{x:Bind InnerContent}"
			IsPaneOpen="{x:Bind IsPaneOpen, Mode=TwoWay}"
			ItemContextInvoked="SideBar_ItemContextInvoked"
			ItemDropped="SideBar_ItemDropped"
			ItemInvoked="SideBar_ItemInvoked"
			Items="{x:Bind ViewModel.SideBarItems, Mode=OneWay}"
			Loaded="SideBar_Loaded"
			SelectedItem="{x:Bind SelectedItem, Mode=TwoWay}" />

		<VisualStateManager.VisualStateGroups>
			<VisualStateGroup x:Name="TogglePaneButtonStates">
				<VisualState x:Name="TogglePaneButtonHidden" />
				<VisualState x:Name="TogglePaneButtonVisible">
					<VisualState.StateTriggers>
						<triggers:CompareStateTrigger
							Comparison="Equal"
							Value="{x:Bind DisplayMode, Mode=OneWay}"
							To="Minimal" />
					</VisualState.StateTriggers>
					<VisualState.Setters>
						<Setter Target="TogglePaneButton.Visibility" Value="Visible" />
					</VisualState.Setters>
				</VisualState>
			</VisualStateGroup>
		</VisualStateManager.VisualStateGroups>
	</Grid>
</UserControl>
